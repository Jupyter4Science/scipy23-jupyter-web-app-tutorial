# AUTOGENERATED! DO NOT EDIT! File to edit: ../../04_widgets.ipynb.

# %% auto 0
__all__ = ['DATA_DIR', 'DATA_FILE', 'original_data', 'year_range', 'selected', 'selected_data_output', 'window_size',
           'poly_order', 'plot_output', 'on_range_change', 'display_selected_data', 'on_poly_order_change',
           'on_window_size_change', 'display_plot']

# %% ../../04_widgets.ipynb 6
import pandas as pd
import os
from matplotlib import pyplot as plt
from scipy.signal import savgol_filter
import ipywidgets as widgets # add import statement

# %% ../../04_widgets.ipynb 8
DATA_DIR = 'data'
DATA_FILE = 'land-ocean-temp-index.csv'

original_data = pd.read_csv(os.path.join(DATA_DIR, DATA_FILE), escapechar='#')
original_data

# %% ../../04_widgets.ipynb 10
year_range = widgets.IntRangeSlider(description = 'Range of Years')
year_range

# %% ../../04_widgets.ipynb 15
year_range.max =  max(original_data['Year'])  # set the 'max' attribute of the slider to the minimum year of the our data  
year_range.min = min(original_data['Year'])  # and let's do the same for 'min'

# %% ../../04_widgets.ipynb 21
selected = original_data[(original_data['Year'] >= year_range.value[0]) & (original_data['Year'] <= year_range.value[1])] # selected = original_data[(original_data['Year'] >= from_year) & (original_data['Year'] <= to_year)]

# %% ../../04_widgets.ipynb 30
def on_range_change(change):
    global selected
    selected = original_data[(original_data['Year'] >= change['new'][0]) & (original_data['Year'] <= change['new'][1])]

# %% ../../04_widgets.ipynb 40
year_range.observe(on_range_change, 'value') # year_range.observe(on_range_change)

# %% ../../04_widgets.ipynb 44
selected_data_output = widgets.Output()
selected_data_output

# %% ../../04_widgets.ipynb 48
def display_selected_data(change): 
    selected_data_output.clear_output(wait=True)
    with selected_data_output: 
        display(selected)

# %% ../../04_widgets.ipynb 49
display_selected_data(None)

# %% ../../04_widgets.ipynb 52
year_range.observe(display_selected_data, 'value')

# %% ../../04_widgets.ipynb 60
window_size = widgets.IntSlider(description = 'Window Size', min=1, max=100)

# %% ../../04_widgets.ipynb 62
poly_order = widgets.BoundedIntText(description = 'Poly Order', min=0, max=10)

# %% ../../04_widgets.ipynb 70
def on_poly_order_change(change):
    global original_data, selected
    original_data['Savitzky-Golay'] = savgol_filter(original_data['Temperature'], window_size.value, change['new']) # original_data['Savitzky-Golay'] = savgol_filter(original_data['Temperature'], window_size, poly_order)
    selected = original_data[(original_data['Year'] >= year_range.value[0]) & (original_data['Year'] <= year_range.value[1])]

# %% ../../04_widgets.ipynb 71
poly_order.observe(on_poly_order_change, 'value')
poly_order.observe(display_selected_data, 'value')

# %% ../../04_widgets.ipynb 76
def on_window_size_change(change):
    global original_data, selected, poly_order
    poly_order.max = min(10, change['new'] - 1) # change the maximum of the poly_order widget
    original_data['Savitzky-Golay'] = savgol_filter(original_data['Temperature'], change['new'], poly_order.value)
    selected = original_data[(original_data['Year'] >= year_range.value[0]) & (original_data['Year'] <= year_range.value[1])]

# %% ../../04_widgets.ipynb 78
window_size.observe(on_window_size_change, 'value')
window_size.observe(display_selected_data, 'value')

# %% ../../04_widgets.ipynb 81
window_size.value = 10
poly_order.value = 1

# %% ../../04_widgets.ipynb 86
plot_output = widgets.Output() # create an output widget called plot_output
plot_output

# %% ../../04_widgets.ipynb 89
def display_plot(change): 
    plot_output.clear_output(wait=True) 
    with plot_output: 
        plt.xlabel('Year') 
        plt.ylabel('Temperature') 
        plt.plot(selected['Year'], selected['Temperature']) 
        plt.plot(selected['Year'], selected['Savitzky-Golay']) 
        plt.show() 

# %% ../../04_widgets.ipynb 93
year_range.observe(display_plot, 'value')
window_size.observe(display_plot, 'value')
poly_order.observe(display_plot, 'value')

# %% ../../04_widgets.ipynb 94
year_range.value = (1900, 2000)
